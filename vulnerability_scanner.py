#!/usr/bin/env python

import scanner


target_url = "http://10.0.2.20/dvwa/"
links_to_ignore = "http://10.0.2.20/dvwa/logout.php"


data_dict = {"username": "admin", "password", "password", "Login": "submit"}

vuln_scanner = scanner.Scanner(target_url. links_to_ignore)
vuln_scanner.session.post("http://10.0.2.20/dvwa/login.php", data=data_dict)


forms = vuln_scanner.extract_forms("http://10.0.2.20/dvwa/vulnerabilities/xss_r/")

print(forms)

# submit something to a form
response = vuln_scanner.submit_form(forms[0], "hello testtest", "http://10.0.2.20/dvwa/vulnerabilities/xss_r")
print(response.content)

# test xss vuln in form
response = vuln_scanner.test_xss_in_form(forms[0], "hello testtest", "http://10.0.2.20/dvwa/vulnerabilities/xss_r")
print(response)

# test xss vuln in link
response = vuln_scanner.test_xss_in_link("http://10.0.2.20/dvwa/vulnerabilities/xss_r/?nsme=test")
print(response)



########################
# run the final scanner

# crawl all possible subdomains
vuln_scanner.crawl()
# run the method of the class to find things in crawled subdomains
vuln_scanner.run_scanner()

